<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>creedenzymatic • creedenzymatic</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="creedenzymatic">
<meta property="og:description" content="creedenzymatic">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">creedenzymatic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/creedenzymatic.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kalganem/creedenzymatic">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="creedenzymatic_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>creedenzymatic</h1>
            
      
      
      <div class="hidden name"><code>creedenzymatic.Rmd</code></div>

    </div>

    
    
<div id="intro" class="section level1">
<h1 class="hasAnchor">
<a href="#intro" class="anchor"></a>Intro</h1>
<p><em>creedenzymatic</em> is a pipeline R package to combine, standardize and visualize kinomic analyses from different tools (KRSA, UKA, KEA3, PTM-SEA)</p>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>installation</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="co">#devtools::install_github("kalganem/creedenzymatic")</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">creedenzymatic</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="input" class="section level1">
<h1 class="hasAnchor">
<a href="#input" class="anchor"></a>Input</h1>
<p>The different kinomic tools (KRSA, UKA, KEA3, PTM-SEA) produce different outputs with various scoring metrics. To standardize the input in this package, we want to extract only two variables from each tool: <strong>Kinase</strong> and <strong>Score.</strong></p>
<p><strong>Kinase</strong>: will be main identifier used in each tool. For example, in KRSA this variable will indicating kinase family, but with UKA it will be individual kinases.</p>
<p><strong>Score</strong>: The main metric used in the corresponding tool. For example, in KRSA this will be a Z score, in UKA it will be either kinase statistic or kinase score.</p>
<div id="input-format" class="section level3">
<h3 class="hasAnchor">
<a href="#input-format" class="anchor"></a>Input Format</h3>
<p>The format of the input is a dataframe with two columns: Kinase and Score. Many of these tools give outputs with many columns beyond these two. So, we need to convert the output from these tools to fit the input format needed here. An example from KRSA and UKA is show below.</p>
</div>
<div id="krsa-example" class="section level2">
<h2 class="hasAnchor">
<a href="#krsa-example" class="anchor"></a>KRSA Example</h2>
<p>Usually the final KRSA output has many columns like: Kinase, SamplingAverage, SD, Z, … etc. So, we need to read that file and only select Kinase and Z score columns, and then rename the Z score column to “Score”</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># reading an example of KRSA output</span>
<span class="va">krsa_ex</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span><span class="st">"data_files/KRSA_ex.txt"</span>, delim <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span>

<span class="va">krsa_ex</span>
<span class="co">#&gt; # A tibble: 24 x 5</span>
<span class="co">#&gt;    Kinase Observed SamplingAvg    SD     Z</span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 DDR          31       21.1   2.65 3.71 </span>
<span class="co">#&gt;  2 TEC          92       81.9   3.09 3.26 </span>
<span class="co">#&gt;  3 SRC         101       94.6   2.70 2.36 </span>
<span class="co">#&gt;  4 ABL          44       37.6   3.14 2.03 </span>
<span class="co">#&gt;  5 PDGFR        86       80.0   3.19 1.89 </span>
<span class="co">#&gt;  6 INSR         24       19.4   2.51 1.83 </span>
<span class="co">#&gt;  7 FRK          11        7.90  1.70 1.83 </span>
<span class="co">#&gt;  8 MET          23       20.5   2.61 0.945</span>
<span class="co">#&gt;  9 SYK          78       75.0   3.23 0.930</span>
<span class="co">#&gt; 10 CSK          45       42.0   3.34 0.912</span>
<span class="co">#&gt; # … with 14 more rows</span></code></pre></div>
<p>Now we select the Kinase and Z score columns, and then rename the Z score column to “Score”</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># selecting the Kinase and Z columns, and renaming Z to Score</span>
<span class="va">krsa_ex</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">Kinase</span>, <span class="va">Z</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">rename</span><span class="op">(</span>Score <span class="op">=</span> <span class="va">Z</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">krsa_ex</span>

<span class="va">krsa_ex</span>
<span class="co">#&gt; # A tibble: 24 x 2</span>
<span class="co">#&gt;    Kinase Score</span>
<span class="co">#&gt;    &lt;chr&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1 DDR    3.71 </span>
<span class="co">#&gt;  2 TEC    3.26 </span>
<span class="co">#&gt;  3 SRC    2.36 </span>
<span class="co">#&gt;  4 ABL    2.03 </span>
<span class="co">#&gt;  5 PDGFR  1.89 </span>
<span class="co">#&gt;  6 INSR   1.83 </span>
<span class="co">#&gt;  7 FRK    1.83 </span>
<span class="co">#&gt;  8 MET    0.945</span>
<span class="co">#&gt;  9 SYK    0.930</span>
<span class="co">#&gt; 10 CSK    0.912</span>
<span class="co">#&gt; # … with 14 more rows</span></code></pre></div>
</div>
<div id="uka-exmaple" class="section level2">
<h2 class="hasAnchor">
<a href="#uka-exmaple" class="anchor"></a>UKA Exmaple</h2>
<p>We do the same with the UKA output, take raw output and select kinase and either the kinase statistic or final score as the scoring metric</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># reading an example of UKA output</span>
<span class="va">uka_ex</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span><span class="st">"data_files/UKA_ex.txt"</span>, delim <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span>

<span class="va">uka_ex</span>
<span class="co">#&gt; # A tibble: 76 x 10</span>
<span class="co">#&gt;    `Kinase Uniprot… `Kinase Name` `Mean Specifici… `Mean Significa…</span>
<span class="co">#&gt;    &lt;chr&gt;            &lt;chr&gt;                    &lt;dbl&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt;  1 P06239           Lck                      1.82              1.03</span>
<span class="co">#&gt;  2 P07948           Lyn                      1.54              1.03</span>
<span class="co">#&gt;  3 Q04912           Ron                      1.07              1.03</span>
<span class="co">#&gt;  4 P42685           FRK                      1.30              1.03</span>
<span class="co">#&gt;  5 P00519           Abl                      1.33              1.03</span>
<span class="co">#&gt;  6 Q06418           Tyro3/Sky                1.12              1.03</span>
<span class="co">#&gt;  7 P12931           Src                      0.994             1.03</span>
<span class="co">#&gt;  8 P16234           PDGFR[alpha]             0.910             1.03</span>
<span class="co">#&gt;  9 P42684           Arg                      0.959             1.03</span>
<span class="co">#&gt; 10 P06241           Fyn                      1.04              1.03</span>
<span class="co">#&gt; # … with 66 more rows, and 6 more variables: `Mean Final Score` &lt;dbl&gt;, `Median</span>
<span class="co">#&gt; #   Final score` &lt;dbl&gt;, `Mean Kinase Statistic` &lt;dbl&gt;, `Median Kinase</span>
<span class="co">#&gt; #   Statistic` &lt;dbl&gt;, `SD Kinase Statitistic` &lt;dbl&gt;, `Mean peptide set</span>
<span class="co">#&gt; #   size` &lt;dbl&gt;</span></code></pre></div>
<p>Let’s say we want the final score as the metric we want to use, so we select the two columns: kinase and median final score</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># selecting the Kinase and kinase statistic columns, and renaming kinase statistic to Score</span>
<span class="va">uka_ex</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">`Kinase Name`</span>, <span class="va">`Median Final score`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">rename</span><span class="op">(</span>Kinase <span class="op">=</span> <span class="va">`Kinase Name`</span>, Score <span class="op">=</span> <span class="va">`Median Final score`</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">uka_ex</span>

<span class="va">uka_ex</span>
<span class="co">#&gt; # A tibble: 76 x 2</span>
<span class="co">#&gt;    Kinase       Score</span>
<span class="co">#&gt;    &lt;chr&gt;        &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Lck           2.77</span>
<span class="co">#&gt;  2 Lyn           2.52</span>
<span class="co">#&gt;  3 Ron           2.50</span>
<span class="co">#&gt;  4 FRK           2.35</span>
<span class="co">#&gt;  5 Abl           2.29</span>
<span class="co">#&gt;  6 Tyro3/Sky     2.19</span>
<span class="co">#&gt;  7 Src           2.07</span>
<span class="co">#&gt;  8 PDGFR[alpha]  2.06</span>
<span class="co">#&gt;  9 Arg           1.97</span>
<span class="co">#&gt; 10 Fyn           1.95</span>
<span class="co">#&gt; # … with 66 more rows</span></code></pre></div>
</div>
<div id="using-the-creedenzymatic-package" class="section level2">
<h2 class="hasAnchor">
<a href="#using-the-creedenzymatic-package" class="anchor"></a>Using the creedenzymatic package</h2>
<p>There are dedicated functions to read and rank KRSA and UKA tables in the creedenzymatic package (<em>read_krsa, read_uka</em>). These two functions will check the input format (must include two columns: Kinase and Score) and then will the <em>rank_kinases</em> function with the specified arguments. The argument are <em>trns</em> and <em>sort</em>. The <em>trns</em> argument is for transformation of the score, the values accepted for this argument are abs and raw (abs: use absolute values of scores, raw: no transformation). The <em>sort</em> argument accepts either asc or desc (ascending and descending)</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># read and rank the KRSA table and use absolute values and descending sorting</span>
<span class="fu"><a href="../reference/read_krsa.html">read_krsa</a></span><span class="op">(</span><span class="va">krsa_ex</span>, trns <span class="op">=</span> <span class="st">"abs"</span>, sort <span class="op">=</span> <span class="st">"desc"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">krsa_table_ranked</span>

<span class="co"># read and rank the UKA table and use absolute values and descending sorting</span>
<span class="fu"><a href="../reference/read_uka.html">read_uka</a></span><span class="op">(</span><span class="va">uka_ex</span>, trns <span class="op">=</span> <span class="st">"abs"</span>, sort <span class="op">=</span> <span class="st">"desc"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">uka_table_ranked</span>


<span class="co"># preview of a ranked KRSA table</span>
<span class="va">krsa_table_ranked</span>
<span class="co">#&gt; # A tibble: 24 x 6</span>
<span class="co">#&gt;    Kinase Score  Rank Method  Perc   Qrt</span>
<span class="co">#&gt;    &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 DDR    3.71      1 KRSA   1         1</span>
<span class="co">#&gt;  2 TEC    3.26      2 KRSA   0.957     1</span>
<span class="co">#&gt;  3 SRC    2.36      3 KRSA   0.913     1</span>
<span class="co">#&gt;  4 ABL    2.03      4 KRSA   0.870     1</span>
<span class="co">#&gt;  5 PDGFR  1.89      5 KRSA   0.826     1</span>
<span class="co">#&gt;  6 INSR   1.83      6 KRSA   0.783     1</span>
<span class="co">#&gt;  7 FRK    1.83      7 KRSA   0.739     2</span>
<span class="co">#&gt;  8 MET    0.945     8 KRSA   0.696     2</span>
<span class="co">#&gt;  9 SYK    0.930     9 KRSA   0.652     2</span>
<span class="co">#&gt; 10 CSK    0.912    10 KRSA   0.609     2</span>
<span class="co">#&gt; # … with 14 more rows</span></code></pre></div>
<p>Now we combine the ranked tables into one datframe using the combine_tools() function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># combine ranked tables</span>
<span class="fu"><a href="../reference/combine_tools.html">combine_tools</a></span><span class="op">(</span>KRSA_df <span class="op">=</span> <span class="va">krsa_table_ranked</span>, UKA_df <span class="op">=</span> <span class="va">uka_table_ranked</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">combined_df</span>


<span class="va">combined_df</span>
<span class="co">#&gt; # A tibble: 152 x 8</span>
<span class="co">#&gt;    Kinase       Score  Rank Method  Perc   Qrt Uniprot_Gene KinaseFamily</span>
<span class="co">#&gt;    &lt;chr&gt;        &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       </span>
<span class="co">#&gt;  1 Lck           2.77     1 UKA    1         1 LCK          SRC         </span>
<span class="co">#&gt;  2 Lyn           2.52     2 UKA    0.987     1 LYN          SRC         </span>
<span class="co">#&gt;  3 Ron           2.50     3 UKA    0.973     1 MST1R        MET         </span>
<span class="co">#&gt;  4 FRK           2.35     4 UKA    0.96      1 FRK          FRK         </span>
<span class="co">#&gt;  5 Abl           2.29     5 UKA    0.947     1 ABL1         ABL         </span>
<span class="co">#&gt;  6 Tyro3/Sky     2.19     6 UKA    0.933     1 TYRO3        AXL         </span>
<span class="co">#&gt;  7 Src           2.07     7 UKA    0.92      1 SRC          SRC         </span>
<span class="co">#&gt;  8 PDGFR[alpha]  2.06     8 UKA    0.907     1 PDGFRA       PDGFR       </span>
<span class="co">#&gt;  9 Arg           1.97     9 UKA    0.893     1 ABL2         ABL         </span>
<span class="co">#&gt; 10 Fyn           1.95    10 UKA    0.88      1 FYN          SRC         </span>
<span class="co">#&gt; # … with 142 more rows</span>

<span class="co"># to save file</span>
<span class="co"># write_delim(combined_df,"ce_combined_ranked_file.txt", delim = "\t")</span></code></pre></div>
<p>We can visualize the results using the quartile_figure() function (which will return a ggplot). Let’s we want to plot all of the kinases found in quartile 1 or 2 either in KRSA or UKA.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># filter out kinases found in quartile 1 or 2 either in KRSA or UKA and use the quartile_figure() for visualization</span>

<span class="va">combined_df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Qrt</span> <span class="op">&lt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">pull</span><span class="op">(</span><span class="va">Uniprot_Gene</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">sig_kinases</span>

<span class="va">combined_df</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Uniprot_Gene</span> <span class="op">%in%</span> <span class="va">sig_kinases</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/quartile_figure.html">quartile_figure</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="creedenzymatic_files/figure-html/unnamed-chunk-4-1.png" width="1152" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Khaled Alganem.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
